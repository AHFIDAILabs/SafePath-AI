<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GBV Risk Prediction Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --primary-color: #2c3e50;
      --secondary-color: #18bc9c;
      --panel-bg: linear-gradient(135deg, rgba(24,188,156,0.8), rgba(44,62,80,0.8));
      --warning-color: #f39c12;
    }

    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background: url('../static/images/home.png');
      background-size: cover;
      background-attachment: fixed;
      color: #fff;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }

    nav {
      background: var(--primary-color);
      padding: 1rem 2rem;
      display: flex;
      justify-content: center;
      gap: 2rem;
    }

    nav a {
      color: #fff;
      text-decoration: none;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: color 0.3s;
    }

    nav a:hover,
    nav a.active {
      color: var(--secondary-color);
    }

    main {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 2rem;
      gap: 2rem;
    }

    .form-section {
      width: 100%;
      max-width: 1000px;
      max-height: 80vh;
      overflow-y: auto;
      background: var(--panel-bg);
      backdrop-filter: blur(12px);
      padding: 2rem;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.4);
      border: 1px solid rgba(255,255,255,0.25);
      color: #f9f9f9;
      animation: fadeInUp 0.8s ease;
    }

    .form-section h2 {
      margin-top: 0;
      text-align: center;
      color: #fff;
      text-shadow: 0 1px 4px rgba(0,0,0,0.5);
    }

    .form-content-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin-top: 1.5rem;
    }

    @media (max-width: 900px) {
      .form-content-container {
        grid-template-columns: 1fr;
      }
    }

    .socio-demographic-section,
    .vulnerability-index-section {
      background: rgba(255, 255, 255, 0.08);
      padding: 1.5rem;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.15);
    }

    .form-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1rem;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    label {
      font-weight: bold;
      margin-bottom: 0.5rem;
      color: #e0e0e0;
    }

    input, select {
      padding: 0.5rem;
      border: none;
      border-radius: 6px;
      outline: none;
      color: #333;
      background: #fff;
      transition: border-color 0.3s;
    }

    select:invalid {
      color: #999;
    }

    select:invalid option[value=""] {
      display: none;
    }

    .checkbox-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 0.75rem;
    }

    .checkbox-group {
      display: flex;
      align-items: center;
    }

    .checkbox-group input[type="checkbox"] {
      margin-right: 0.5rem;
      width: auto;
    }

    .checkbox-group label {
      margin-left: 0.5rem;
      margin-bottom: 0;
      color: #ddd;
    }

    .btn-primary {
      background: var(--secondary-color);
      color: #fff;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      font-weight: bold;
      font-size: 1rem;
      transition: transform 0.2s ease, background 0.3s ease;
    }

    .btn-primary:hover {
      background: #149174;
      transform: translateY(-2px);
    }

    .btn-primary:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }

    .btn-wrapper {
      grid-column: span 2;
      text-align: center;
      margin-top: 1rem;
    }

    .form-validation-info {
      background: rgba(243, 156, 18, 0.1);
      border: 1px solid rgba(243, 156, 18, 0.3);
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1.5rem;
      color: #f39c12;
    }

    .form-validation-info p {
      margin: 0;
      font-size: 0.9rem;
    }

    /* Results Section Styles */
    .results-container {
      width: 100%;
      max-width: 1200px;
      background: var(--panel-bg);
      backdrop-filter: blur(12px);
      padding: 2rem;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.4);
      border: 1px solid rgba(255,255,255,0.25);
      color: #f9f9f9;
      animation: fadeInUp 0.8s ease;
    }

    .results-header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .results-summary {
      display: flex;
      gap: 1.5rem;
      justify-content: center;
      text-align: center;
      margin-bottom: 3rem;
      flex-wrap: wrap;
    }

    .summary-card {
      flex: 1;
      min-width: 200px;
      max-width: 250px;
      padding: 1.5rem;
      background: rgba(255,255,255,0.1);
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.2);
    }

    .summary-card h3 {
      margin-top: 0;
      color: #18bc9c;
      font-size: 1rem;
      margin-bottom: 1rem;
    }

    .summary-card p {
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 0;
    }

    .risk-high { color: #ff6b6b; }
    .risk-low { color: #51cf66; }

    /* NEW: Tab Navigation Styles */
    .tabs-nav {
      display: flex;
      justify-content: center;
      border-bottom: 2px solid rgba(24, 188, 156, 0.3);
      margin-bottom: 1.5rem;
    }

    .tab-btn {
      padding: 1rem 1.5rem;
      cursor: pointer;
      background: transparent;
      border: none;
      color: #e0e0e0;
      font-size: 1rem;
      font-weight: bold;
      transition: all 0.3s ease;
      border-bottom: 3px solid transparent;
      margin-bottom: -2px; /* Align with parent border */
    }

    .tab-btn:hover {
      background: rgba(24, 188, 156, 0.1);
      color: #fff;
    }

    .tab-btn.active {
      color: var(--secondary-color);
      border-bottom-color: var(--secondary-color);
    }

    .tab-btn i {
      margin-right: 0.5rem;
    }

    /* UPDATED: Analysis Section Styles for Tabs */
    .analysis-content-area {
      margin-top: 1.5rem;
    }
    
    .tab-pane {
      display: none; /* Hide panes by default */
      animation: fadeInUp 0.5s ease;
    }

    .tab-pane.active {
      display: block; /* Show active pane */
    }

    .analysis-section {
      background: rgba(255,255,255,0.08);
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.15);
      padding: 2rem;
      min-height: 450px;
    }

    .analysis-section h3 {
      margin: 0 0 1.5rem 0;
      color: #18bc9c;
      font-size: 1.5rem;
      text-align: center;
    }

    .insights-content {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .summary-section, .recommendations-section {
      background: rgba(255,255,255,0.05);
      padding: 1rem;
      border-radius: 8px;
    }

    .summary-section h4, .recommendations-section h4 {
      color: #18bc9c;
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 1rem;
    }

    .summary-section ul, .recommendations-section ul {
      margin: 0.5rem 0;
      padding-left: 1.2rem;
    }

    .summary-section li, .recommendations-section li {
      margin-bottom: 0.5rem;
      line-height: 1.4;
      color: #e0e0e0;
    }

    .chart-container {
      height: 450px;
      position: relative;
    }
    
    .chart-description {
      margin-top: 15px;
      padding: 15px;
      background: #222;
      border-radius: 8px;
      color: #fff;
      font-size: 1rem;
      line-height: 1.6;
      border-left: 4px solid #18bc9c;
    }

    .model-input-display {
      background: rgba(0,0,0,0.3);
      padding: 1rem;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 0.85rem;
      color: #e0e0e0;
      white-space: pre-wrap;
      overflow-x: auto;
      line-height: 1.4;
    }

    .loader {
      border: 8px solid rgba(255,255,255,0.3);
      border-radius: 50%;
      border-top: 8px solid var(--secondary-color);
      width: 60px;
      height: 60px;
      animation: spin 1s linear infinite;
      margin: 2rem auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .error {
      color: #ff6b6b;
      background: rgba(255,107,107,0.1);
      padding: 1rem;
      border-radius: 5px;
      margin: 1rem 0;
      border: 1px solid rgba(255,107,107,0.3);
    }

    footer {
      background: var(--primary-color);
      padding: 1rem 2rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #fff;
      font-size: 0.9rem;
    }

    .footer-center {
      text-align: center;
      flex: 1;
    }

    .footer-left {
      text-align: left;
    }

    .footer-right img {
      height: 40px;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>
<body>

  <nav>
    <a href="index.html"><i class="fas fa-home"></i> Home</a>
    <a href="dashboard.html" class="active"><i class="fas fa-chart-line"></i> Dashboard</a>
    <a href="faq.html"><i class="fas fa-question-circle"></i> FAQ</a>
  </nav>

  <main>
    <section class="form-section">
      <h2>Assessing Individual Risk of Gender-Based Violence (GBV)</h2>
      
      <div class="form-validation-info" style="text-align: center;">
        <p><i class="fas fa-info-circle"></i> All fields must be filled in accurately for a reliable risk assessment.</p>
      </div>
      
      <form id="prediction-form" method="post" action="" onsubmit="return false;">
        <div class="form-content-container">
          <!-- Socio-demographic Factors -->
          <div class="socio-demographic-section">
            <h3>Socio-demographic Factors</h3>
            <div class="form-grid">
              <div class="form-group">
                <label for="survivor_age">Age</label>
                <input type="number" id="survivor_age" name="survivor_age" min="1" max="90" required placeholder="Enter age (1-90)">
              </div>
              <div class="form-group">
                <label for="survivor_sex">Gender</label>
                <select id="survivor_sex" name="survivor_sex" required>
                  <option value="" disabled selected>Select gender</option>
                  <option value="Female">Female</option>
                  <option value="Male">Male</option>
                </select>
              </div>
              <div class="form-group">
                <label for="marital_status">Marital Status</label>
                <select id="marital_status" name="marital_status" required>
                  <option value="" disabled selected>Select marital status</option>
                  <option value="Married/cohabiting">Married/cohabiting</option>
                  <option value="Single">Single</option>
                  <option value="Widowed">Widowed</option>
                  <option value="Divorced/separated">Divorced/separated</option>
                  <option value="Unknown">Unknown</option>
                </select>
              </div>
              <div class="form-group">
                <label for="educational_status">Educational Level</label>
                <select id="educational_status" name="educational_status" required>
                  <option value="" disabled selected>Select educational level</option>
                  <option value="No formal">No formal education</option>
                  <option value="Some primary">Some primary</option>
                  <option value="Completed primary">Completed primary</option>
                  <option value="Some secondary">Some secondary</option>
                  <option value="Completed secondary">Completed secondary</option>
                  <option value="Diploma">Diploma</option>
                  <option value="Undergraduate">Undergraduate</option>
                  <option value="Graduate">Graduate</option>
                  <option value="Postgraduate">Postgraduate</option>
                  <option value="Unknown">Unknown</option>
                </select>
              </div>
              <div class="form-group">
                <label for="employment_status_victim_main">Employment Status</label>
                <select id="employment_status_victim_main" name="employment_status_victim_main" required>
                  <option value="" disabled selected>Select employment status</option>
                  <option value="Unemployed">Unemployed</option>
                  <option value="Self employed">Self employed</option>
                  <option value="Currently employed">Currently employed</option>
                  <option value="Other">Other</option>
                  <option value="Not reported">Not reported</option>
                  <option value="Unknown">Unknown</option>
                </select>
              </div>
              <div class="form-group">
                <label for="who_survivor_victim_stay_with">Who do you live with?</label>
                <select id="who_survivor_victim_stay_with" name="who_survivor_victim_stay_with" required>
                  <option value="" disabled selected>Select living arrangement</option>
                  <option value="Partner">Partner</option>
                  <option value="Guardian">Guardian</option>
                  <option value="Parent">Parent</option>
                  <option value="Alone">Alone</option>
                  <option value="Other">Other</option>
                  <option value="Unknown">Unknown</option>
                </select>
              </div>
              <div class="form-group">
                <label for="employment_status_main">Main Provider Employment Status</label>
                <select id="employment_status_main" name="employment_status_main" required>
                  <option value="" disabled selected>Select main provider employment</option>
                  <option value="Unemployed">Unemployed</option>
                  <option value="Self employed">Self employed</option>
                  <option value="Currently employed">Currently employed</option>
                  <option value="Other">Other</option>
                  <option value="Not reported">Not reported</option>
                  <option value="Unknown">Unknown</option>
                </select>
              </div>
            </div>
          </div>

          <!-- Vulnerability Factors -->
          <div class="vulnerability-index-section">
            <h3>Vulnerability Factors</h3>
            <p style="font-size: 0.9rem; color: #ccc; margin-bottom: 1rem;">Check all that apply:</p>
            <div class="checkbox-grid">
              <div class="checkbox-group"><input type="checkbox" id="PLWD" name="PLWD" value="1"><label for="PLWD">Do you have a disability?</label></div>
              <div class="checkbox-group"><input type="checkbox" id="PLHIV" name="PLHIV" value="1"><label for="PLHIV">Living with HIV?</label></div>
              <div class="checkbox-group"><input type="checkbox" id="IDP" name="IDP" value="1"><label for="IDP">Are you displaced?</label></div>
              <div class="checkbox-group"><input type="checkbox" id="widow" name="widow" value="1"><label for="widow">Are you a widow?</label></div>
              <div class="checkbox-group"><input type="checkbox" id="minor" name="minor" value="1"><label for="minor">Are you a minor?</label></div>
              <div class="checkbox-group"><input type="checkbox" id="out_of_school_child" name="out_of_school_child" value="1"><label for="out_of_school_child">Are you an out of school child?</label></div>
              <div class="checkbox-group"><input type="checkbox" id="orphans" name="orphans" value="1"><label for="orphans">Are you an orphan?</label></div>
              <div class="checkbox-group"><input type="checkbox" id="household_help" name="household_help" value="1"><label for="household_help">Are you a household help?</label></div>
              <div class="checkbox-group"><input type="checkbox" id="child_apprentice" name="child_apprentice" value="1"><label for="child_apprentice">Are you a child apprentice?</label></div>
              <div class="checkbox-group"><input type="checkbox" id="female_sex_worker" name="female_sex_worker" value="1"><label for="female_sex_worker">Do you engage in sex work?</label></div>
              <div class="checkbox-group"><input type="checkbox" id="drug_user" name="drug_user" value="1"><label for="drug_user">Do you use drugs?</label></div>
            </div>
          </div>

          <!-- Submit Button -->
          <div class="btn-wrapper">
            <button type="submit" id="predict-btn" class="btn-primary">Predict Risk Assessment</button>
          </div>
        </div>
      </form>
    </section>

    <!-- Results section -->
    <div id="results-container" class="results-container" style="display: none;">
      <div id="loader" class="loader" style="display: none;"></div>
      <div id="results-content">
        <div class="results-header">
          <h2>Prediction Result</h2>
        </div>
        
        <div class="results-summary">
          <div class="summary-card">
            <h3>Risk Level</h3>
            <p id="prediction-text" class="risk-high"></p>
          </div>
          <div class="summary-card">
            <h3>Risk Probability</h3>
            <p id="probability-text"></p>
          </div>
          <div class="summary-card">
            <h3>Confidence</h3>
            <p id="confidence-text"></p>
          </div>
        </div>

        <!-- NEW: Tab Navigation -->
        <div class="tabs-nav">
          <button class="tab-btn active" onclick="showTab('insights')"><i class="fas fa-brain"></i> Data-Driven Insights</button>
          <button class="tab-btn" onclick="showTab('drivers')"><i class="fas fa-balance-scale"></i> Key Drivers of the Prediction</button>
          <button class="tab-btn" onclick="showTab('input')"><i class="fas fa-code"></i> Model Input</button>
        </div>

        <!-- NEW: Tab Content Area -->
        <div class="analysis-content-area">
          <!-- I. Data-Driven Insights Pane -->
          <div id="insights-section" class="tab-pane active">
            <div class="analysis-section">
                <h3>Data-Driven Insights</h3>
                <div class="insights-content">
                    <div class="summary-section">
                        <h4><i class="fas fa-chart-line"></i> Assessment Summary and Analysis</h4>
                        <ul id="assessment-summary"><!-- Populated by JavaScript --></ul>
                    </div>
                    <div class="recommendations-section">
                        <h4><i class="fas fa-lightbulb"></i> Recommendations</h4>
                        <ul id="recommendations-list"><!-- Populated by JavaScript --></ul>
                    </div>
                </div>
            </div>
          </div>

          <!-- II. Key Drivers Pane -->
          <div id="drivers-section" class="tab-pane">
            <div class="analysis-section">
                <h3>Key Drivers of the Prediction</h3>
                <div class="chart-container">
                    <canvas id="waterfall-chart"></canvas>
                    <div class="chart-description"></div>
                </div>
            </div>
          </div>

          <!-- III. Model Input Pane -->
          <div id="input-section" class="tab-pane">
            <div class="analysis-section">
                <h3>Model Input</h3>
                <h4 style="color: #18bc9c; margin-bottom: 1rem;">Features sent to the model</h4>
                <div class="model-input-display" id="model-features"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer>
    <div class="footer-left">
      Contact: info@ahfid.org | +2347061718721
    </div>
    <div class="footer-center">
      Â© 2025 AI-Based GBV Predictive Tool. All rights reserved.
    </div>
    <div class="footer-right">
      <img src="../static/images/ahfid_logo.png" alt="AHFID Logo">
    </div>
  </footer>

  <script src="../static/js/dashboard.js"></script>
</body>
</html>